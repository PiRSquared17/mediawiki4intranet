# HG changeset patch
# User Vitaliy Filippov <vitali@st-filippov.office.custis.ru>
# Date 1292339419 -10800
Bug 73311 - Rearrange edit form contents, remove copyright warnings

diff -r 2951a613ce57 -r 7919920078ee includes/EditPage.php
--- includes/EditPage.php
+++ includes/EditPage.php
@@ -1268,14 +1268,16 @@
 			htmlspecialchars( wfMsg( 'edithelp' ) ).'</a> '.
 			htmlspecialchars( wfMsg( 'newwindow' ) );
 
-		global $wgRightsText;
-		if ( $wgRightsText ) {
-			$copywarnMsg = array( 'copyrightwarning',
-				'[[' . wfMsgForContent( 'copyrightpage' ) . ']]',
-				$wgRightsText );
-		} else {
-			$copywarnMsg = array( 'copyrightwarning2',
-				'[[' . wfMsgForContent( 'copyrightpage' ) . ']]' );
+		global $wgRightsText, $wgNoCopyrightWarnings;
+		if ( !$wgNoCopyrightWarnings ) {
+			if ( $wgRightsText ) {
+				$copywarnMsg = array( 'copyrightwarning',
+					'[[' . wfMsgForContent( 'copyrightpage' ) . ']]',
+					$wgRightsText );
+			} else {
+				$copywarnMsg = array( 'copyrightwarning2',
+					'[[' . wfMsgForContent( 'copyrightpage' ) . ']]' );
+			}
 		}
 
 		if ( $wgUser->getOption('showtoolbar') and !$this->isCssJsSubpage ) {
@@ -1422,7 +1424,8 @@
 );
 		$this->showTextbox1( $classes );
 
-		$wgOut->wrapWikiMsg( "<div id=\"editpage-copywarn\">\n$1\n</div>", $copywarnMsg );
+		if ( !$wgNoCopyrightWarnings )
+			$wgOut->wrapWikiMsg( "<div id=\"editpage-copywarn\">\n$1\n</div>", $copywarnMsg );
 		$wgOut->addHTML( <<<END
 {$this->editFormTextAfterWarn}
 {$metadata}
@@ -1457,16 +1460,7 @@
 
 		$this->showEditTools();
 
-		$wgOut->addHTML( <<<END
-{$this->editFormTextAfterTools}
-<div class='templatesUsed'>
-{$formattedtemplates}
-</div>
-<div class='hiddencats'>
-{$formattedhiddencats}
-</div>
-END
-);
+		$wgOut->addHTML( $this->editFormTextAfterTools );
 
 		if ( $this->isConflict && wfRunHooks( 'EditPageBeforeConflictDiff', array( &$this, &$wgOut ) ) ) {
 			$wgOut->wrapWikiMsg( '==$1==', "yourdiff" );
@@ -1480,6 +1474,17 @@
 		}
 		$wgOut->addHTML( $this->editFormTextBottom );
 		$wgOut->addHTML( "</form>\n" );
+
+		$wgOut->addHTML( <<<END
+<div class='templatesUsed'>
+{$formattedtemplates}
+</div>
+<div class='hiddencats'>
+{$formattedhiddencats}
+</div>
+END
+);
+
 		if ( !$wgUser->getOption( 'previewontop' ) ) {
 			$this->displayPreviewArea( $previewOutput, false );
 		}
