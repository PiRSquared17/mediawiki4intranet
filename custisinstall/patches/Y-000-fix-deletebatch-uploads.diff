# HG changeset patch
# User Vitaliy Filippov <vitalif@yourcmc.ru>
# Date 1308146188 -14400
Bug 79994 - Fix DeleteBatch bug: it does not delete uploads

diff -r 45da8fc662c9 -r 1732c61b0857 extensions/DeleteBatch/DeleteBatch.body.php
--- extensions/DeleteBatch/DeleteBatch.body.php
+++ extensions/DeleteBatch/DeleteBatch.body.php
@@ -290,14 +290,15 @@
 			/*this is absolutely required - creating a new ImagePage object does not automatically
 			provide it with image  */
 			$art->img = new Image( $art->mTitle );
+			$art->delete();
 		} else {
 			$art = new Article( $page );
+			$art->doDelete( $reason );
 		}
 
 		/* what is the generic reason for page deletion?
 		   something about the content, I guess...
 		*/
-		$art->doDelete( $reason );
 		$db->commit();
 		return true;
 	}
