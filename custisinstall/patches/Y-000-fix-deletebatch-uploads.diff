# HG changeset patch
# User Vitaliy Filippov <vitalif@yourcmc.ru>
# Date 1327949335 -14400
Bug 79994 - Fix DeleteBatch bug: it does not delete uploads

diff -r 6b6371ec1416 -r 6f4bc4849c50 extensions/DeleteBatch/DeleteBatch.body.php
--- extensions/DeleteBatch/DeleteBatch.body.php
+++ extensions/DeleteBatch/DeleteBatch.body.php
@@ -310,14 +310,15 @@
 		/* this stuff goes like articleFromTitle in Wiki.php */
 		if ( $page->getNamespace() == NS_FILE ) {
 			$art = new ImagePage( $page );
+			$art->delete();
 		} else {
 			$art = new Article( $page );
+			$art->doDelete( $reason );
 		}
 
 		/* what is the generic reason for page deletion?
 		   something about the content, I guess...
 		*/
-		$art->doDelete( $reason );
 		$db->commit();
 		return true;
 	}
