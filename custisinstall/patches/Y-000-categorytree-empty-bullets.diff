# HG changeset patch
# User Vitaliy Filippov <vitalif@yourcmc.ru>
# Date 1327949621 -14400
Bug 59835 - Remove unwanted clickable [+] bullets near non-expandable categories

diff -r 6b6371ec1416 -r 53881f18cb64 extensions/CategoryTree/CategoryTree.css
--- extensions/CategoryTree/CategoryTree.css
+++ extensions/CategoryTree/CategoryTree.css
@@ -16,8 +16,7 @@
 	margin-left: 1.5ex;
 }
 
-
-.CategoryTreeBullet {
+.CategoryTreeClickable {
 	cursor: pointer;
 	cursor: hand; /* hack for MSIE 5.0 and 5.5 */
 }
diff -r 6b6371ec1416 -r 53881f18cb64 extensions/CategoryTree/CategoryTree.i18n.php
--- extensions/CategoryTree/CategoryTree.i18n.php
+++ extensions/CategoryTree/CategoryTree.i18n.php
@@ -34,7 +34,7 @@
 	'categorytree-expand'           => 'expand',
 	'categorytree-collapse-bullet'  => '[<b>−</b>]', # do not translate or duplicate this message to other languages
 	'categorytree-expand-bullet'    => '[<b>+</b>]', # do not translate or duplicate this message to other languages
-	'categorytree-empty-bullet'     => '[<b>×</b>]', # do not translate or duplicate this message to other languages
+	'categorytree-empty-bullet'     => '[<b style="visibility:hidden">×</b>]', # do not translate or duplicate this message to other languages
 	'categorytree-page-bullet'      => '&nbsp;', # do not translate or duplicate this message to other languages
 
 	'categorytree-member-counts'    => 'contains {{PLURAL:$1|1 subcategory|$1 subcategories}}, {{PLURAL:$2|1 page|$2 pages}}, and {{PLURAL:$3|1 file|$3 files}}', # $1=subcategories, $2=subpages, $3=files, $4=total, $5=shown-in-tree
diff -r 6b6371ec1416 -r 53881f18cb64 extensions/CategoryTree/CategoryTree.js
--- extensions/CategoryTree/CategoryTree.js
+++ extensions/CategoryTree/CategoryTree.js
@@ -50,7 +50,7 @@
 
 function categoryTreeLoadNode(cat, options, lnk, div) {
 	div.style.display= 'block';
-	lnk.className= 'CategoryTreeLoaded';
+	lnk.className= 'CategoryTreeLoaded CategoryTreeClickable';
 	lnk.innerHTML= categoryTreeCollapseBulletMsg;
 	lnk.title= categoryTreeCollapseMsg;
 	lnk.onclick= function() { categoryTreeCollapseNode(cat, options, lnk) };
diff -r 6b6371ec1416 -r 53881f18cb64 extensions/CategoryTree/CategoryTreeFunctions.php
--- extensions/CategoryTree/CategoryTreeFunctions.php
+++ extensions/CategoryTree/CategoryTreeFunctions.php
@@ -675,6 +675,7 @@
 					$linkattr[ 'onclick' ] = "if (this.href) this.href='javascript:void(0)'; categoryTreeExpandNode('" . Xml::escapeJsString( $key ) . "'," . $this->getOptionsAsJsStructure() . ",this);";
 					# Don't load this message for ajax requests, so that we don't have to initialise $wgLang
 					$linkattr[ 'title' ] = $this->mIsAjaxRequest ? '##LOAD##' : wfMsgNoTrans( 'categorytree-expand' );
+					$linkattr[ 'class' ] .= ' CategoryTreeClickable';
 				} else {
 					$tag = 'span';
 					$txt = wfMsgNoTrans( 'categorytree-collapse-bullet' );
